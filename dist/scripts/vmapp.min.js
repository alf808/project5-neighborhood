function neighborhoodMapViewModel(){function e(e,o,a){var n=a[1]+"<br>"+a[2]+"<br>"+a[3]+"<br>Rating: "+a[4]+"<br>URL: "+a[5],t="<strong>"+e+"</strong><hr>FOURSQUARE Info:<br>"+n;l&&l.close();var i=document.createElement("div");i.innerHTML=t,l.setContent(i),l.open(map,o),o.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.setAnimation(null)},1e3)}function o(e,o){var a=document.createElement("div");a.className="reset-button",a.title="Click to recenter the map",e.appendChild(a);var n=document.createElement("div");n.className="reset-button-text",n.innerHTML="Reset Kapahulu Map",a.appendChild(n),google.maps.event.addDomListener(a,"click",function(){o.setCenter(g),o.setZoom(16),l&&l.close(),p.query("")})}function a(){map=new google.maps.Map(f,v),t(),map.controls[google.maps.ControlPosition.TOP_RIGHT].push(p.list);{var e=document.createElement("div");new o(e,map)}e.index=1,map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e),map.controls[google.maps.ControlPosition.TOP_LEFT].push(b);var a=window.setTimeout(n,8e3);google.maps.event.addListener(map,"tilesloaded",function(){window.clearTimeout(a)}),google.maps.event.addListener(map,"click",function(){l.close()}),mapCenter=map.getCenter()}function n(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function t(){l=new google.maps.InfoWindow;for(var e=window.mapBounds,o=googleplaces.length,a=0;o>a;a++){var n=googleplaces[a][0],t=googleplaces[a][1],s=googleplaces[a][3],r=googleplaces[a][2],m=new u(map,r,n,t,s);i(s),e.extend(new google.maps.LatLng(c,d)),p.pins.push(m)}map.fitBounds(e)}function i(e){var o="http://api.foursquare.com/v2/venues/"+e+"?oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare&format=json";$.getJSON(o,function(o){s(o,e)}).error(function(e){console.log("oops")})}function s(e,o){var a=e.response.venue;m.push([o,a.contact.formattedPhone||" ",a.location.formattedAddress[0]||" ",a.location.formattedAddress[1]||" ",a.rating||" ",a.url||" "])}function r(e){for(var o,a=m.length,n=0;a>n;n++)if(m[n][0]===e){o=m[n];break}return o}var l,p=this,m=[],c=21.2790587,d=-157.81368810000004,g=new google.maps.LatLng(c,d);p.pins=ko.observableArray(),p.query=ko.observable("");var u=function(o,a,n,t,i){var s,l=this;l.fsqid=ko.observable(i),l.googlename=ko.observable(a),l.lat=ko.observable(n),l.lon=ko.observable(t),s=new google.maps.Marker({icon:"img/red-dot.png",position:new google.maps.LatLng(n,t)}),l.marker=ko.observable(s),l.isVisible=ko.observable(!1),l.isVisible.subscribe(function(e){s.setMap(e?o:null)}),l.isVisible(!0),google.maps.event.addListener(s,"click",function(){var n=r(i);o.panTo(s.position),mapCenter=o.setCenter(s.position),e(a,s,n)})};p.list=document.getElementById("list");var b=document.getElementById("pac-input"),f=document.getElementById("map-canvas"),v={zoom:16,maxZoom:16,minZoom:10,center:g,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};p.filterPins=ko.computed(function(){var e=p.query().toLowerCase();return ko.utils.arrayFilter(p.pins(),function(o){var a=o.googlename().toLowerCase().indexOf(e)>=0;return o.isVisible(a),a})}),p.clickMarker=function(o){var a=r(o.fsqid()),n=new google.maps.LatLng(o.lat(),o.lon());map.panTo(n),mapCenter=map.setCenter(n),e(o.googlename(),o.marker(),a)},google.maps.event.addDomListener(window,"load",a),window.mapBounds=new google.maps.LatLngBounds,google.maps.event.addDomListener(window,"resize",function(){map.setCenter(mapCenter)})}var googleplaces=[[21.275936,-157.814551,"Rainbow Drive-In","4b058655f964a520ea5c22e3"],[21.280072,-157.814183,"Ono Hawaiian Foods","4b058653f964a5208e5c22e3"],[21.27885,-157.814144,"Side Street Inn","4c4a6bd8c668e21e95f898f8"],[21.2786,-157.81370000000004,"Papa John's Pizza","4bbabd8653649c74406a49fb"],[21.277741,-157.813856,"Uncle Bo's Pupu Bar & Grill","4b058656f964a5206a5d22e3"],[21.281801,-157.81444699999997,"Haili's Hawaiian Food","4b36d86bf964a520543d25e3"],[21.281342,-157.814256,"Yakitori Glad Hawaii","4f24fe9de4b0d10db11500b2"],[21.279026,-157.81379100000004,"Starbucks Coffee","4b05fccbf964a520fae622e3"],[21.280317,-157.81392,"Taco Bell","4d6dbaa732ab5941e5c680b9"],[21.278312,-157.813671,"Zippy's Kapahulu","4aee4eaaf964a52077d321e3"],[21.282899,-157.813576,"Waiola Shave Ice","4bb9276f3db7b713c110229a"],[21.280828,-157.813852,"Ono Seafood Takeaway","4b902633f964a5209d7833e3"],[21.279021,-157.813692,"Kozo Sushi","4bc7e89b8b7c9c742d6d37cf"],[21.281363,-157.814347,"Pizza Hut","4b9f1fe0f964a520b51437e3"],[21.278881,-157.813688,"Tenkaippin Hawaii","4b058656f964a520605d22e3"],[21.277838,-157.81381999999996,"Irifune Restaurant","4b071fa2f964a520b2f722e3"],[21.27691,-157.814208,"Sunrise Restaurant","4c1da836fcf8c9b6853aac0b"]],map,mapCenter;ko.applyBindings(new neighborhoodMapViewModel);