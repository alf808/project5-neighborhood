function neighborhoodMapViewModel(){function o(o,e){var n=document.createElement("div");n.className="reset-button",n.title="Click to recenter the map",o.appendChild(n);var a=document.createElement("div");a.className="reset-button-text",a.innerHTML="Reset Kapahulu Map",n.appendChild(a),google.maps.event.addDomListener(n,"click",function(){e.setCenter(g),e.setZoom(16),googleinfowin&&googleinfowin.close(),s.query("")})}function e(){map=new google.maps.Map(p,u),a(),map.controls[google.maps.ControlPosition.TOP_RIGHT].push(s.list);{var e=document.createElement("div");new o(e,map)}e.index=1,map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e),map.controls[google.maps.ControlPosition.TOP_LEFT].push(c);var t=window.setTimeout(n,8e3);google.maps.event.addListener(map,"tilesloaded",function(){window.clearTimeout(t)}),google.maps.event.addListener(map,"click",function(){googleinfowin.close()})}function n(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function a(){googleinfowin=new google.maps.InfoWindow;for(var o=window.mapBounds,e=0;e<googleplaces.length;e++){var n=googleplaces[e][0],a=googleplaces[e][1],t=googleplaces[e][3],i=googleplaces[e][2],g=new Pin(map,i,n,a,t,e);o.extend(new google.maps.LatLng(l,r)),s.pins.push(g)}map.fitBounds(o),map.setCenter(o.getCenter())}function t(o){var e=foursquareData[o];i=e[0]+"<br>"+e[1]+"<br>"+e[2]+"<br>"+e[3]+"<br>"+e[4]}var i,s=this,l=21.2790587,r=-157.81368810000004,g=new google.maps.LatLng(l,r);s.pins=ko.observableArray([]),s.query=ko.observable(""),s.foursquareInfo="",s.list=document.getElementById("list");var c=document.getElementById("pac-input"),p=document.getElementById("map-canvas"),u={zoom:16,maxZoom:16,minZoom:10,center:g,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};s.filterPins=ko.computed(function(){var o=s.query().toLowerCase();return ko.utils.arrayFilter(s.pins(),function(e){var n=e.googlename().toLowerCase().indexOf(o)>=0;return e.isVisible(n),n})}),s.clickMarker=function(o){t(o.idx());var e=new google.maps.LatLng(o.lat(),o.lon()),n=o.marker();map.panTo(e),googleinfowin&&googleinfowin.close(),setTimeout(function(){var e=o.googlename()+"<br>Foursquare Info:<br>"+i,a=document.createElement("div");a.innerHTML=e,googleinfowin.setContent(a),googleinfowin.open(map,n),n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.setAnimation(null)},1e3)},500)},google.maps.event.addDomListener(window,"load",e),window.mapBounds=new google.maps.LatLngBounds,window.addEventListener("resize",function(o){map.fitBounds(mapBounds)})}var googleplaces=[[21.275936,-157.814551,"Rainbow Drive-In","4b058655f964a520ea5c22e3"],[21.280072,-157.814183,"Ono Hawaiian Foods","4b058653f964a5208e5c22e3"],[21.27885,-157.814144,"Side Street Inn","4c4a6bd8c668e21e95f898f8"],[21.2786,-157.81370000000004,"Papa John's Pizza","4bbabd8653649c74406a49fb"],[21.277741,-157.813856,"Uncle Bo's Pupu Bar & Grill","4b058656f964a5206a5d22e3"],[21.281801,-157.81444699999997,"Haili's Hawaiian Food","4b36d86bf964a520543d25e3"],[21.281342,-157.814256,"Yakitori Glad Hawaii","4f24fe9de4b0d10db11500b2"],[21.279026,-157.81379100000004,"Starbucks Coffee","4b05fccbf964a520fae622e3"],[21.280317,-157.81392,"Taco Bell","4d6dbaa732ab5941e5c680b9"],[21.278312,-157.813671,"Zippy's Kapahulu","4aee4eaaf964a52077d321e3"],[21.282899,-157.813576,"Waiola Shave Ice","4bb9276f3db7b713c110229a"],[21.280828,-157.813852,"Ono Seafood Takeaway","4b902633f964a5209d7833e3"],[21.279021,-157.813692,"Kozo Sushi","4bc7e89b8b7c9c742d6d37cf"],[21.281363,-157.814347,"Pizza Hut","4b9f1fe0f964a520b51437e3"],[21.278881,-157.813688,"Tenkaippin Hawaii","4b058656f964a520605d22e3"],[21.277838,-157.81381999999996,"Irifune Restaurant","4b071fa2f964a520b2f722e3"],[21.27691,-157.814208,"Sunrise Restaurant","4c1da836fcf8c9b6853aac0b"]],map,googleinfowin,foursquareData=[],Pin=function(o,e,n,a,t,i){function s(o,e){var n=o.response.venue,a=n.contact.formattedPhone||" ",t=n.location.formattedAddress[0]||" ",i=n.location.formattedAddress[1]||" ",s=n.rating||" ",r=n.url||" ";l=a+"<br>"+t+"<br>"+i+"<br>Rating: "+s+"<br>"+r;var g=[a,t,i,s,r];console.log(g),foursquareData.push(g)}var l,r,g=this;g.googlename=ko.observable(e),g.lat=ko.observable(n),g.lon=ko.observable(a),g.idx=ko.observable(i),r=new google.maps.Marker({icon:"img/red-dot.png",position:new google.maps.LatLng(n,a)}),g.marker=ko.observable(r),g.isVisible=ko.observable(!1),g.isVisible.subscribe(function(e){r.setMap(e?o:null)}),g.isVisible(!0),function(){var o="http://api.foursquare.com/v2/venues/"+t+"?oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare&format=json";$.getJSON(o,function(o){s(o,i)}).error(function(o){console.log("oops")})}(),google.maps.event.addListener(r,"click",function(){var n=e+"<br>Foursquare Info:<br>"+l;googleinfowin&&googleinfowin.close(),googleinfowin.setContent(n),googleinfowin.open(o,r),o.panTo(r.position),r.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){r.setAnimation(null)},1e3)})};ko.applyBindings(new neighborhoodMapViewModel);