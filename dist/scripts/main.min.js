function appOctopus(){function o(){var o=c.getCenter();u=o.lat(),f=o.lng()}function e(o,e){var t=document.createElement("div");t.style.backgroundColor="yellow",t.style.border="2px solid #fff",t.style.borderRadius="3px",t.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",t.style.cursor="pointer",t.style.marginBottom="22px",t.style.marginLeft="5px",t.style.textAlign="center",t.title="Click to recenter the map",o.appendChild(t);var n=document.createElement("div");n.style.color="rgb(25,25,25)",n.style.fontFamily="Roboto,Arial,sans-serif",n.style.fontSize="16px",n.style.lineHeight="38px",n.style.paddingLeft="5px",n.style.paddingRight="5px",n.innerHTML="Center Map",t.appendChild(n),google.maps.event.addDomListener(t,"click",function(){e.setCenter(v)})}function t(){var t=document.getElementById("map-canvas"),i={zoom:13,maxZoom:18,minZoom:9,center:v,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};c=new google.maps.Map(t,i),a(),o(),m.getFoursquareInfo();{var l=document.createElement("div");new e(l,c)}l.index=1,c.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(l);var p=document.getElementById("list");c.controls[google.maps.ControlPosition.TOP_RIGHT].push(p);var g=document.getElementById("pac-input");c.controls[google.maps.ControlPosition.TOP_LEFT].push(g);var u=new google.maps.places.SearchBox(g);google.maps.event.addListener(u,"places_changed",function(){var e=u.getPlaces();d(),m.allPlaces.removeAll();for(var t,n=new google.maps.LatLngBounds,a=0;10>a;a++)void 0!==e[a]&&(t=e[a],r(t),s(t),n.extend(t.geometry.location));c.fitBounds(n),o()}),google.maps.event.addListener(c,"bounds_changed",function(){var o=c.getBounds();u.setBounds(o)});var f=window.setTimeout(n,5e3);google.maps.event.addListener(c,"tilesloaded",function(){window.clearTimeout(f)})}function n(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function a(){var o={location:v,radius:700,types:["meal_takeaway","restaurant","bar","cafe","food"]};g=new google.maps.InfoWindow,p=new google.maps.places.PlacesService(c),p.nearbySearch(o,i)}function i(o,e){e==google.maps.places.PlacesServiceStatus.OK&&(bounds=new google.maps.LatLngBounds,o.forEach(function(o){o.marker=s(o),bounds.extend(new google.maps.LatLng(o.geometry.location.lat(),o.geometry.location.lng()))}),c.fitBounds(bounds),o.forEach(r))}function s(o){var e,t=new google.maps.Marker({map:c,icon:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",name:o.name.toLowerCase(),position:o.geometry.location,place_id:o.place_id,animation:google.maps.Animation.DROP});void 0!==o.vicinity?e=o.vicinity:void 0!==o.formatted_address&&(e=o.formatted_address);var n='<div style="font-weight: bold">'+o.name+"</div><br>"+e+"<br>"+m.foursquareInfo;return google.maps.event.addListener(t,"click",function(){g.setContent(n),g.open(c,this),c.panTo(t.position),t.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){t.setAnimation(null)},1450)}),y.push(t),t}function l(o,e){var t=ko.observable();return ko.computed(function(){o.call(e).done(t)}),t}function r(o){var e={};e.place_id=o.place_id,e.position=o.geometry.location.toString(),e.name=o.name;var t;void 0!==o.vicinity?t=o.vicinity:void 0!==o.formatted_address&&(t=o.formatted_address),e.address=t,m.allPlaces.push(e)}function d(){for(var o=0;o<y.length;o++)y[o].setMap(null);y.length=0}var c,p,g,m=this,u="21.2790587",f="-157.81368810000004",v=new google.maps.LatLng(21.2790587,-157.81368810000004),y=[];m.allPlaces=ko.observableArray([]),m.foursquareInfo="",this.getFoursquareInfo=l(function(){var o="http://api.foursquare.com/v2/venues/search?ll="+u+","+f+"&oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare";return $.getJSON(o,{format:"json"})},this),m.clickMarker=function(o){for(var e,t=0;t<y.length;t++)if(o.place_id===y[t].place_id){e=y[t];break}c.panTo(e.position);var n='<div style="font-weight: bold">'+o.name+"</div><div>"+o.address+"</div>"+m.foursquareInfo;g.setContent(n),g.open(c,e),e.setAnimation(google.maps.Animation.DROP)},google.maps.event.addDomListener(window,"load",t)}$(function(){ko.applyBindings(new appOctopus)});