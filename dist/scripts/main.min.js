function neighborhoodMapViewModel(){function e(e,o){var n=document.createElement("div");n.className="reset-button",n.title="Click to recenter the map",e.appendChild(n);var t=document.createElement("div");t.className="reset-button-text",t.innerHTML="Reset Kapahulu Map",n.appendChild(t),google.maps.event.addDomListener(n,"click",function(){o.setCenter(u),o.setZoom(16),l&&l.close(),r.query("")})}function o(){map=new google.maps.Map(d,v),t(),map.controls[google.maps.ControlPosition.TOP_RIGHT].push(r.list);{var o=document.createElement("div");new e(o,map)}o.index=1,map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(o),map.controls[google.maps.ControlPosition.TOP_LEFT].push(g);var a=window.setTimeout(n,8e3);google.maps.event.addListener(map,"tilesloaded",function(){window.clearTimeout(a)}),google.maps.event.addListener(map,"click",function(){l.close()})}function n(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function t(){var e={location:u,radius:500,types:["restaurant","cafe","food"]};l=new google.maps.InfoWindow,i=new google.maps.places.PlacesService(map),i.nearbySearch(e,a)}function a(e,o){if(o==google.maps.places.PlacesServiceStatus.OK){results=e.slice(0,16);var n=window.mapBounds;results.forEach(function(e){var o=e.geometry.location.lat(),t=e.geometry.location.lng(),a=new c(map,e.name,o,t,e.place_id);n.extend(new google.maps.LatLng(m,p)),r.pins.push(a)}),map.fitBounds(n),map.setCenter(n.getCenter())}}function s(e,o){var n="http://api.foursquare.com/v2/venues/search?ll="+e+","+o+"&oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare";$.getJSON(n,function(e){console.log("4SQ info: "+e.response.venues[0].name+"\n"+e.response.venues[0].id),r.foursquareInfo=e.response.venues[0].name}).error(function(e){console.log("oops")})}var i,l,r=this,m=21.2790587,p=-157.81368810000004,u=new google.maps.LatLng(m,p);r.pins=ko.observableArray([]),r.query=ko.observable(""),r.foursquareInfo="";var c=function(e,o,n,t,a){var s;this.googlename=ko.observable(o),this.lat=ko.observable(n),this.lon=ko.observable(t),s=new google.maps.Marker({icon:"img/red-dot.png",position:new google.maps.LatLng(n,t),place_id:a}),this.marker=ko.observable(s),this.isVisible=ko.observable(!1),this.isVisible.subscribe(function(o){s.setMap(o?e:null)}),this.isVisible(!0),google.maps.event.addListener(s,"click",function(){var n=o;l&&l.close(),l.setContent(n),l.open(e,s),e.panTo(s.position),s.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){s.setAnimation(null)},1e3)})};r.list=document.getElementById("list");var g=document.getElementById("pac-input"),d=document.getElementById("map-canvas"),v={zoom:16,maxZoom:16,minZoom:10,center:u,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};r.filterPins=ko.computed(function(){var e=r.query().toLowerCase();return ko.utils.arrayFilter(r.pins(),function(o){var n=o.googlename().toLowerCase().indexOf(e)>=0;return o.isVisible(n),n})}),r.clickMarker=function(e){s(e.lat(),e.lon());var o=new google.maps.LatLng(e.lat(),e.lon()),n=e.marker();map.panTo(o),l&&l.close(),setTimeout(function(){var o=e.googlename()+"<br>4sq: "+r.foursquareInfo,t=document.createElement("div");t.innerHTML=o,l.setContent(t),l.open(map,n),n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.setAnimation(null)},1e3)},500)},google.maps.event.addDomListener(window,"load",o),window.mapBounds=new google.maps.LatLngBounds,window.addEventListener("resize",function(e){map.fitBounds(mapBounds)})}var map,fsidArray=[];ko.applyBindings(new neighborhoodMapViewModel);