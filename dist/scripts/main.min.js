function neighborhoodMapViewModel(){function o(){var o=c.getCenter();u=o.lat(),v=o.lng()}function e(o,e){var n=document.createElement("div");n.className="reset-button",n.title="Click to recenter the map",o.appendChild(n);var t=document.createElement("div");t.className="reset-button-text",t.innerHTML="Center Map",n.appendChild(t),google.maps.event.addDomListener(n,"click",function(){e.setCenter(f)})}function n(){var n=document.getElementById("map-canvas"),i={zoom:13,maxZoom:18,minZoom:9,center:f,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};c=new google.maps.Map(n,i),a(),o(),p.getFoursquareInfo();{var r=document.createElement("div");new e(r,c)}r.index=1,c.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(r);var m=document.getElementById("list");c.controls[google.maps.ControlPosition.TOP_RIGHT].push(m);var g=document.getElementById("pac-input");c.controls[google.maps.ControlPosition.TOP_LEFT].push(g);var u=new google.maps.places.SearchBox(g);google.maps.event.addListener(u,"places_changed",function(){var e=u.getPlaces();d(),p.allPlaces.removeAll();for(var n,t=new google.maps.LatLngBounds,a=0;10>a;a++)void 0!==e[a]&&(n=e[a],l(n),s(n),t.extend(n.geometry.location));c.fitBounds(t),o()}),google.maps.event.addListener(c,"bounds_changed",function(){var o=c.getBounds();u.setBounds(o)});var v=window.setTimeout(t,5e3);google.maps.event.addListener(c,"tilesloaded",function(){window.clearTimeout(v)})}function t(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function a(){var o={location:f,radius:700,types:["meal_takeaway","restaurant","bar","cafe","food"]},e={location:f,radius:700,types:["meal_takeaway","restaurant","bar","cafe","food"],query:"restaurant"};g=new google.maps.InfoWindow,m=new google.maps.places.PlacesService(c),m.nearbySearch(o,i),m.textSearch(e,i)}function i(o,e){e==google.maps.places.PlacesServiceStatus.OK&&(bounds=new google.maps.LatLngBounds,o.forEach(function(o){o.marker=s(o),bounds.extend(new google.maps.LatLng(o.geometry.location.lat(),o.geometry.location.lng()))}),c.fitBounds(bounds),o.forEach(l))}function s(o){var e,n=new google.maps.Marker({map:c,icon:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",name:o.name.toLowerCase(),position:o.geometry.location,place_id:o.place_id,animation:google.maps.Animation.DROP});void 0!==o.vicinity?e=o.vicinity:void 0!==o.formatted_address&&(e=o.formatted_address);var t='<div style="font-weight: bold">'+o.name+"</div><br>"+e+"<br>"+p.foursquareInfo;return google.maps.event.addListener(n,"click",function(){g.setContent(t),g.open(c,this),c.panTo(n.position),n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.setAnimation(null)},1450)}),h.push(n),n}function r(o,e){var n=ko.observable();return ko.computed(function(){o.call(e).done(n)}),n}function l(o){var e={};e.place_id=o.place_id,e.position=o.geometry.location.toString(),e.name=o.name;var n;void 0!==o.vicinity?n=o.vicinity:void 0!==o.formatted_address&&(n=o.formatted_address),e.address=n,p.allPlaces.push(e)}function d(){for(var o=0;o<h.length;o++)h[o].setMap(null);h.length=0}var c,m,g,p=this,u=21.2790587,v=-157.81368810000004,f=new google.maps.LatLng(u,v),h=[];p.allPlaces=ko.observableArray([]),p.foursquareInfo="",this.getFoursquareInfo=r(function(){var o="http://api.foursquare.com/v2/venues/search?ll="+u+","+v+"&oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare";return $.getJSON(o,{format:"json"})},this),p.clickMarker=function(o){for(var e,n=0;n<h.length;n++)if(o.place_id===h[n].place_id){e=h[n];break}c.panTo(e.position);var t='<div style="font-weight: bold">'+o.name+"</div><div>"+o.address+"</div>"+p.foursquareInfo;g.setContent(t),g.open(c,e),e.setAnimation(google.maps.Animation.DROP)},google.maps.event.addDomListener(window,"load",n)}$(function(){ko.applyBindings(new neighborhoodMapViewModel)});