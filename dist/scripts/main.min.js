function neighborhoodMapViewModel(){function e(e,o){var n=document.createElement("div");n.className="reset-button",n.title="Click to recenter the map",e.appendChild(n);var a=document.createElement("div");a.className="reset-button-text",a.innerHTML="Reset Kapahulu Map",n.appendChild(a),google.maps.event.addDomListener(n,"click",function(){o.setCenter(p),o.setZoom(16),googleinfowin&&googleinfowin.close(),c.query("")})}function o(){map=new google.maps.Map(f,u),a(),map.controls[google.maps.ControlPosition.TOP_RIGHT].push(c.list);{var o=document.createElement("div");new e(o,map)}o.index=1,map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(o),map.controls[google.maps.ControlPosition.TOP_LEFT].push(d);var t=window.setTimeout(n,8e3);google.maps.event.addListener(map,"tilesloaded",function(){window.clearTimeout(t)}),google.maps.event.addListener(map,"click",function(){googleinfowin.close()})}function n(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function a(){var e={location:p,radius:500,types:["restaurant","cafe","food"]};googleinfowin=new google.maps.InfoWindow,l=new google.maps.places.PlacesService(map),l.nearbySearch(e,t)}function t(e,o){if(o==google.maps.places.PlacesServiceStatus.OK){results=e.slice(0,16);var n=window.mapBounds;results.forEach(function(e){var o=e.geometry.location.lat(),a=e.geometry.location.lng(),t=results.indexOf(e),i=new Pin(map,e.name,o,a,e.place_id,t);n.extend(new google.maps.LatLng(g,m)),c.pins.push(i)}),console.log(fsidArray.length),map.fitBounds(n),map.setCenter(n.getCenter())}}function i(e){console.log(fsidArray[e]);var o="http://api.foursquare.com/v2/venues/"+fsidArray[e]+"?oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare&format=json";$.getJSON(o,function(e){s(e)}).error(function(e){console.log("oops")})}function s(e){r=e.response.venue.name,console.log(e.response.venue.name)}var l,r,c=this,g=21.2790587,m=-157.81368810000004,p=new google.maps.LatLng(g,m);c.pins=ko.observableArray([]),c.query=ko.observable(""),c.foursquareInfo="",c.list=document.getElementById("list");var d=document.getElementById("pac-input"),f=document.getElementById("map-canvas"),u={zoom:16,maxZoom:16,minZoom:10,center:p,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};c.filterPins=ko.computed(function(){var e=c.query().toLowerCase();return ko.utils.arrayFilter(c.pins(),function(o){var n=o.googlename().toLowerCase().indexOf(e)>=0;return o.isVisible(n),n})}),c.clickMarker=function(e){i(e.fsqArrayPos());var o=new google.maps.LatLng(e.lat(),e.lon()),n=e.marker();map.panTo(o),googleinfowin&&googleinfowin.close(),setTimeout(function(){var o=e.googlename()+"<br>4sq: "+r,a=document.createElement("div");a.innerHTML=o,googleinfowin.setContent(a),googleinfowin.open(map,n),n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.setAnimation(null)},1e3)},500)},google.maps.event.addDomListener(window,"load",o),window.mapBounds=new google.maps.LatLngBounds,window.addEventListener("resize",function(e){map.fitBounds(mapBounds)})}var map,fsidArray=[],googleinfowin;fsidArray=["4bdcbcf83904a59350894f9e","4b36d86bf964a520543d25e3","4c4a6bd8c668e21e95f898f8","4b058655f964a520ea5c22e3","4b058656f964a5206a5d22e3","4b058653f964a5208e5c22e3","4f24fe9de4b0d10db11500b2","4bb9276f3db7b713c110229a","4b902633f964a5209d7833e3","4b05fccbf964a520fae622e3","4bbabd8653649c74406a49fb","4aee4eaaf964a52077d321e3","4d6dbaa732ab5941e5c680b9","4bc7e89b8b7c9c742d6d37cf","4b9f1fe0f964a520b51437e3","4cde02c9825e721e55e86745"];var Pin=function(e,o,n,a,t,i){function s(e){r=e.response.venue.name}var l,r,c=this;c.fsqid=ko.observable(""),c.googlename=ko.observable(o),c.lat=ko.observable(n),c.lon=ko.observable(a),c.fsqArrayPos=ko.observable(i),l=new google.maps.Marker({icon:"img/red-dot.png",position:new google.maps.LatLng(n,a),place_id:t}),c.marker=ko.observable(l),c.isVisible=ko.observable(!1),c.isVisible.subscribe(function(o){l.setMap(o?e:null)}),c.isVisible(!0),function(){var e="http://api.foursquare.com/v2/venues/"+fsidArray[i]+"?oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare&format=json";$.getJSON(e,function(e){s(e)}).error(function(e){console.log("oops")})}(),google.maps.event.addListener(l,"click",function(){var n=o+"<br>4sq: "+r;googleinfowin&&googleinfowin.close(),googleinfowin.setContent(n),googleinfowin.open(e,l),e.panTo(l.position),l.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){l.setAnimation(null)},1e3)})};ko.applyBindings(new neighborhoodMapViewModel);