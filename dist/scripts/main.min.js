function neighborhoodMapViewModel(){function o(o,e){var n=ko.observable();return ko.computed(function(){o.call(e).done(n)}),n}function e(o,e){var n=document.createElement("div");n.className="reset-button",n.title="Click to recenter the map",o.appendChild(n);var t=document.createElement("div");t.className="reset-button-text",t.innerHTML="Reset Kapahulu Map",n.appendChild(t),google.maps.event.addDomListener(n,"click",function(){e.setCenter(c),e.setZoom(16),infowindow&&infowindow.close(),r.query("")})}function n(){map=new google.maps.Map(g,f),l=new google.maps.places.PlacesService(map),i(),map.controls[google.maps.ControlPosition.TOP_RIGHT].push(r.list);{var o=document.createElement("div");new e(o,map)}o.index=1,map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(o),map.controls[google.maps.ControlPosition.TOP_LEFT].push(d);var n=window.setTimeout(t,8e3);google.maps.event.addListener(map,"tilesloaded",function(){window.clearTimeout(n)})}function t(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function i(){var o={location:c,radius:500,types:["restaurant","cafe","food"]};infowindow=new google.maps.InfoWindow,l.nearbySearch(o,a)}function a(o,e){e==google.maps.places.PlacesServiceStatus.OK&&o.forEach(function(o){var e=o.geometry.location.lat(),n=o.geometry.location.lng(),t=new u(map,o.name,e,n,o.place_id,o.text);r.pins.push(t)})}function s(o,e,n){var t=n.name();google.maps.event.addListener(o,"click",function(){infowindow&&infowindow.close(),infowindow.setContent(t),infowindow.open(map,o),map.panTo(o.position),o.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.setAnimation(null)},1e3)})}var l,r=this,m=21.2790587,p=-157.81368810000004,c=new google.maps.LatLng(m,p);r.pins=ko.observableArray([]),r.query=ko.observable(""),r.foursquareInfo="";var u=function(e,n,t,i,a,l){var r;this.name=ko.observable(n),this.lat=ko.observable(t),this.lon=ko.observable(i),this.text=ko.observable(l),this.fsqid=ko.observable(""),r=new google.maps.Marker({icon:"img/red-dot.png",position:new google.maps.LatLng(t,i),place_id:a,animation:google.maps.Animation.DROP}),this.marker=ko.observable(r),this.isVisible=ko.observable(!1),this.isVisible.subscribe(function(o){r.setMap(o?e:null)}),this.isVisible(!0),s(r,a,this),this.getFoursquareInfo=o(function(){var o="http://api.foursquare.com/v2/venues/search?ll="+t+","+i+"&oauth_token=GQDPA05ROIS0UO5KO3YQEW4KGYBC2QOW1PCKD0HMQR5COFVH&v=20150830&m=foursquare";return $.getJSON(o,{format:"json",limit:1})},this)};r.list=document.getElementById("list");var d=document.getElementById("pac-input"),g=document.getElementById("map-canvas"),f={zoom:16,maxZoom:18,minZoom:10,center:c,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};r.filterPins=ko.computed(function(){var o=r.query().toLowerCase();return ko.utils.arrayFilter(r.pins(),function(e){var n=e.name().toLowerCase().indexOf(o)>=0;return e.isVisible(n),n})}),r.clickMarker=function(o){var e=new google.maps.LatLng(o.lat(),o.lon()),n=o.marker(),t='<div style="font-weight: bold">'+o.name()+"</div>";infowindow.setContent(t),infowindow.open(map,n),map.panTo(e),n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.setAnimation(null)},1e3),console.log(o.getFoursquareInfo().response.venues[0].id)},google.maps.event.addDomListener(window,"load",n)}var map,infowindow;ko.applyBindings(new neighborhoodMapViewModel);