function neighborhoodMapViewModel(){function e(){var e=map.getCenter();m=e.lat(),p=e.lng()}function o(e,o){var n=document.createElement("div");n.className="reset-button",n.title="Click to recenter the map",e.appendChild(n);var t=document.createElement("div");t.className="reset-button-text",t.innerHTML="Center Map",n.appendChild(t),google.maps.event.addDomListener(n,"click",function(){o.setCenter(g)})}function n(){map=new google.maps.Map(u,v),a(),e(),map.controls[google.maps.ControlPosition.TOP_RIGHT].push(r.list);{var n=document.createElement("div");new o(n,map)}n.index=1,map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(n),map.controls[google.maps.ControlPosition.TOP_LEFT].push(d);var s=new google.maps.places.SearchBox(d);google.maps.event.addListener(s,"places_changed",function(){for(var o,n=s.getPlaces(),t=new google.maps.LatLngBounds,a=0;10>a;a++)void 0!==n[a]&&(o=n[a],t.extend(o.geometry.location));map.fitBounds(t),e()}),google.maps.event.addListener(map,"bounds_changed",function(){var e=map.getBounds();s.setBounds(e)});var i=window.setTimeout(t,8e3);google.maps.event.addListener(map,"tilesloaded",function(){window.clearTimeout(i)})}function t(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function a(){var e={location:g,radius:600,types:["meal_takeaway","restaurant","bar","cafe","food"]};l=new google.maps.InfoWindow,i=new google.maps.places.PlacesService(map),i.nearbySearch(e,s)}function s(e,o){o==google.maps.places.PlacesServiceStatus.OK&&(bounds=new google.maps.LatLngBounds,e.forEach(function(e){var o=e.geometry.location.lat(),n=e.geometry.location.lng(),t=new c(map,e.name,o,n,e.place_id,e.text);bounds.extend(new google.maps.LatLng(o,n)),r.pins.push(t)}),map.fitBounds(bounds))}var i,l,r=this,m=21.2790587,p=-157.81368810000004,g=new google.maps.LatLng(m,p);r.pins=ko.observableArray([]),r.foursquareInfo="";var c=function(e,o,n,t,a,s){var i;this.name=ko.observable(o),this.lat=ko.observable(n),this.lon=ko.observable(t),this.text=ko.observable(s),i=new google.maps.Marker({icon:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",position:new google.maps.LatLng(n,t),place_id:a,animation:google.maps.Animation.DROP}),this.isVisible=ko.observable(!1),this.isVisible.subscribe(function(o){i.setMap(o?e:null)}),this.isVisible(!0)};r.list=document.getElementById("list");var d=document.getElementById("pac-input"),u=document.getElementById("map-canvas"),v={zoom:14,maxZoom:18,minZoom:9,center:g,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};r.query=ko.observable(""),r.filterPins=ko.computed(function(){var e=r.query().toLowerCase();return ko.utils.arrayFilter(r.pins(),function(o){var n=o.name().toLowerCase().indexOf(e)>=0;return o.isVisible(n),n})}),google.maps.event.addDomListener(window,"load",n)}var map;ko.applyBindings(new neighborhoodMapViewModel);