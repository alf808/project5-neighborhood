function neighborhoodMapViewModel(){function e(){var e=map.getCenter();p=e.lat(),c=e.lng()}function o(e,o){var a=document.createElement("div");a.className="reset-button",a.title="Click to recenter the map",e.appendChild(a);var t=document.createElement("div");t.className="reset-button-text",t.innerHTML="Center Map",a.appendChild(t),google.maps.event.addDomListener(a,"click",function(){o.setCenter(d)})}function a(){map=new google.maps.Map(v,f),n(),e(),map.controls[google.maps.ControlPosition.TOP_RIGHT].push(m.list);{var a=document.createElement("div");new o(a,map)}a.index=1,map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(a),map.controls[google.maps.ControlPosition.TOP_LEFT].push(u);var i=new google.maps.places.SearchBox(u);google.maps.event.addListener(i,"places_changed",function(){for(var o,a=i.getPlaces(),t=new google.maps.LatLngBounds,n=0;10>n;n++)void 0!==a[n]&&(o=a[n],t.extend(o.geometry.location));map.fitBounds(t),e()}),google.maps.event.addListener(map,"bounds_changed",function(){var e=map.getBounds();i.setBounds(e)});var s=window.setTimeout(t,5e3);google.maps.event.addListener(map,"tilesloaded",function(){window.clearTimeout(s)})}function t(){$("#map-canvas").html("<h1>Google Maps Failed to Load. Please try reloading the page.</h1>")}function n(){var e={location:d,radius:700,types:["meal_takeaway","restaurant","bar","cafe","food"]};l=new google.maps.InfoWindow,r=new google.maps.places.PlacesService(map),r.nearbySearch(e,i)}function i(e,o){o==google.maps.places.PlacesServiceStatus.OK&&(bounds=new google.maps.LatLngBounds,e.forEach(function(e){{var o=e.geometry.location.lat(),a=e.geometry.location.lng();new g(map,e.name,o,a,e.place_id,e.text)}bounds.extend(new google.maps.LatLng(o,a))}),map.fitBounds(bounds),e.forEach(s))}function s(e){var o={};o.place_id=e.place_id,o.position=e.geometry.location.toString(),o.name=e.name;var a;void 0!==e.vicinity?a=e.vicinity:void 0!==e.formatted_address&&(a=e.formatted_address),o.address=a,m.allPlaces.push(o)}var r,l,m=this,p=21.2790587,c=-157.81368810000004,d=new google.maps.LatLng(p,c);m.pins=ko.observableArray([]),m.allPlaces=ko.observableArray([]),m.foursquareInfo="",m.filterPins=ko.computed(function(){var e=m.query().toLowerCase();return ko.utils.arrayFilter(m.pins(),function(o){var a=o.name().toLowerCase().indexOf(e)>=0;return o.isVisible(a),a})});var g=function(e,o,a,t,n,i){var s;this.name=ko.observable(o),this.lat=ko.observable(a),this.lon=ko.observable(t),this.text=ko.observable(i),s=new google.maps.Marker({icon:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",position:new google.maps.LatLng(a,t),place_id:n,animation:google.maps.Animation.DROP}),this.isVisible=ko.observable(!1),this.isVisible.subscribe(function(o){s.setMap(o?e:null)}),this.isVisible(!0)};m.list=document.getElementById("list");var u=document.getElementById("pac-input"),v=document.getElementById("map-canvas"),f={zoom:13,maxZoom:18,minZoom:9,center:d,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};m.onloadList=ko.observableArray([]),m.query=ko.observable(""),m.filteredInitList=ko.computed(function(){m.onloadList().forEach(function(e){e.marker.setMap(null)});var e=ko.utils.arrayFilter(m.cornerList(),function(e){return e.name().toLowerCase().contains(m.query().toLowerCase())});e.forEach(function(e){e.marker.setMap(map)})}),google.maps.event.addDomListener(window,"load",a)}var map;ko.applyBindings(new neighborhoodMapViewModel);